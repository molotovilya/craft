## Что такое сопряжение?

Это эссе находится в рамках теории категорий. Подразумеваю, что вы владеете такими понятиями как: 
- [[1. Категория|категория]] 
- [[функтор и естественное преобразование]]
- [[естественные преобразования]]

Сама же тема этого эссе - **Сопряжённость** или по английски **Adjunction**.  
Если сказать кратко, то сопряжение в теории категорий, это когда у нас есть пара функторов, которые связаны довольно хорошим образом, подожим на изоморфность. Но чуть более гибким, что позволяет находить новые структурные тропы.   
Начнём же с того, откуда возникает идея всего этого. 

---

## Мотивация: от строгости к гибкости

> Я позволю себе сделать провокационное утверждение, что сопряжённость — это концепция фундаментальной логической и математической важности, которая больше нигде в математике не улавливается.
> 
> — Steve Awodey (in _Category Theory_, Oxford Logic Guides)

Итак, что же такое сопряжение?

Один из ключевых вопросов математики - это вопрос о "тождественности". Иначе говоря вопрос о том, когда две вещи можно считать одинаковыми. 

Особенность теории категорий на арене этого вопроса проявляется в понятии [[3. Изоморфизм|изоморфизма]] 

Два объекта $X$ и $Y$ в категории изоморфны, если существует морфизм из одного в другой, у которого есть как левый, так и правый обратный. Изоморфизм — это процесс $X \to Y$, который можно полностью обратить.

Однако изоморфизм не всегда подходит для наших целей. Иногда процесс не является обратимым "в точности", но мы всё же хотим связать начальное и конечное состояния, как неразличимые. Как это сделать? 

---

## Почему равенств бывает недостаточно

Допустим мы хотим сравнить две категории $C$ и $D$ . Будут ли они изоморфны?  
Это значит, что если у нас есть функтор $F: C \to D$, мы можем задаться вопросом: 
могу ли я найти функтор $G: D \to C$ такой, что об будет обратным к $F$

$$
F \circ G = \text{id}_D \quad \text{и} \quad G \circ F = \text{id}_C
$$

Часто ответ будет «нет». Равенство часто оказывается слишком строгим требованием. 
Вот простой пример: 
если $X$ и $Y$ — множества, то их декартовы произведения $X \times Y$ и $Y \times X$, не равны между собой в точности, т.к.:

$$
(x, y) \neq (y, x) \quad \text{для} \quad x \in X, y \in Y
$$
Но если нас интересует  «множество пар элементов из $X$ и $Y$», то нам будет достаточно знать, что хотя $X \times Y$ и $Y \times X$ не равны, они **изоморфны**. Замена равенств на изоморфизмы предоставляет нам желаемую гибкость. Можем ли мы проделать такое с функторами? 

---

## Эквивалентность категорий

Имея это в виду, давайте вернёмся к нашим уравнениям равенств функторов. Если мы заменим эти равенства на **естественные изоморфизмы**, то получим

$$
F \circ G \cong \text{id}_D \quad \text{и} \quad G \circ F \cong \text{id}_C
$$

Тогда категории $C$ и $D$ будут называться **эквивалентными**, а не изоморфными. И такая эквивалентность, это уже более гибкая и удобная форма "тождественности" категорий. Но можем ли мы пойти дальше?

---

## Сопряжение: следующий шаг ослабления

Давайте сделаем ещё один шаг вперёд. Мы заменили равенства $=$ на изоморфизмы $\cong$. А что, если мы пойдём дальше и заменим изоморфизмы на обычные морфизмы? Если мы заменим естественные изоморфизмы на некие **естественные преобразования**:

$$
F \circ G \to \text{id}_D \quad \text{и} \quad \text{id}_C \to G \circ F
$$
тогда мы получим уже категории, которые могут быть не-эквивалентными. Но представляет ли такая конструкция интерес?  

Она называется **сопряжением** (adjunction), а полученные функторы $F$ и $G$ будут называться **сопряжёнными**. Такое простое определение. Но всё ли это? Ну, почти. Нам не подойдут абы какие естественные преобразования.  

Мы хотим потребовать, чтобы они были связаны друг с другом определённым «хорошим» образом, но посмотрим на это ниже. А также посмотрим на то, как такое ослабление даст множество интересных следствий. 

---

## Аналогии из топологии и линейной алгебры

Отвлечёмся ненадолго, чтобы посмотреть как процесс "ослабления" встречается в других областях математики. Какие интересные следствия можно найти в них при ослаблении тождественности? 
### Топология

Так в  топологии существует ослабленная версия гомеоморфизма  - обратимого непрерывного отображения. Такая ослабленная версия называется **гомотопической эквивалентностью**. И такая эквивалентность порождает **теорию гомотопий**. Хотя в данном случае, в теории категорий мы пошли ещё на шаг вперёд


![[топология и теория категорий.jpg]]

### Линейная алгебра

Рассмотрим теперь то же ослабление в линейной алгебре.
Предположим, $U$ — ортогональная (сохраняющая длины) матрица $n \times n$. Она представляет собой обратимое линейное отображение $R^n \to R^n$, обратное к которому является сопряжённой матрицей $U^*$.

$$
U U^* = I = U^* U
$$

Теперь представим, что мы отбросили некоторые столбцы $U$, так что она стала прямоугольной матрицей $n \times k$, где $k < n$. Эта усечённая $U$ становится отображением из $R^k$ в $R^n$.

$$
U^* U = I_k
$$

Интуитивно это означает, что если вы вложите $R^k$ как подпространство в $R^n$, а затем спроецируете обратно на него, вы не сделали ровным счётом ничего. С другой стороны, $U U^*$ больше не является тождественным оператором на $R^n$.

$$
U U^* \neq I_n
$$
Нельзя просто так сжать пространство до меньшей размерности, не потеряв информации. Вы не сможете вернуться обратно и сказать, что всё "так же".  

Таким образом, $U^*$ больше не является обратной к $U$, но обе матрицы по-прежнему несут ценную информацию.

Говоря о линейных отображениях, вы, возможно, вспомните уравнение, которое связывает отображение $f: V \to W$ и его сопряжённое $f^*: W \to V$:

$$
\langle f(v), w \rangle = \langle v, f^*(w) \rangle
$$

Как мы увидим в следующий раз, сопряжение состоит из пары функторов, удовлетворяющих почти идентичному уравнению.

---

## Промежуточный вывод

Ослабление понятия «тождественности» даёт нам дополнительную валюту для исследования новых явлений. Поэтому не думайте о сопряжениях как о суррогате эквивалентности. Вместо этого рассматривайте их как первоклассных граждан категорийного ландшафта.

> Понятие сопряжённого функтора захватывает важный математический феномен, который невидим без линзы теории категорий.
> 
> — Steve Awodey


Теперь рассмотрим несколько примеров и разберём определение более формально 

## Мотивация формального определения

Мы поговорили о лёгком введении в сопряжения в теории категорий. Как мы видели, сопряжение состоит из пары противоположно направленных функторов $F$ и $G$ вместе с естественными преобразованиями $\text{id} \to G \circ F$ и $F \circ G \to \text{id}$.

Мы сравнили это с двумя более строгими сценариями:

1.  Когда композиции функторов **равны** тождественным:
    $$
    F \circ G = \text{id} \quad \text{и} \quad G \circ F = \text{id}
    $$
    Этот сценарий определяет **изоморфизм категорий**.

1.  Когда композиции функторов **естественно изоморфны** тождественным:
    $$
    F \circ G \cong \text{id} \quad \text{и} \quad G \circ F \cong \text{id}
    $$
    
2. Этот сценарий определяет **эквивалентность категорий**.

Сопряжение занимает **третью** ступеньку в этом списке ослабления условий.

![[равенство, изоморфизм, сопряжённость.jpg]]



В случае сопряжения мы также требуем, чтобы естественные преобразования — называемые **единицей** (unit) и **коединицей** (counit) — в некотором смысле вели себя как обратные друг другу.

Это объясняет, почему **стрелки** направлены в противоположные стороны. (Это также объясняет приставку «ко»). Однако они не могут быть буквально обратными, поскольку не являются композируемыми: одно преобразование включает морфизмы в категории $C$, а другое — морфизмы в $D$. То есть их области определения не совпадают.

Но мы можем исправить это, применив функторы $F$ и $G$, так что (изменённые версии) единицы и коединицы действительно можно будет скомпоновать. Это мотивирует формальное определение сопряжения.

---

## Формальное определение

Вот оно:

**Определение:** Сопряжение между категориями $C$ и $D$ — это пара функторов $F: C \to D$ и $G: D \to C$ вместе с естественными преобразованиями:

*   $\eta: \text{id}_C \to G \circ F$, называемым **единицей** (unit),
*   $\epsilon: F \circ G \to \text{id}_D$, называемым **коединицей** (counit),

такими, что для всех объектов $X$ в $C$ и $Y$ в $D$ следующие два треугольника коммутируют:

![[правая и левая сопряжённость.jpg]]


Когда $F$ и $G$ являются частью сопряжения, мы будем писать $F \dashv G$ и говорить, что $F$ и $G$ — **сопряжённые функторы**, где $F$ называется **левым сопряжённым** к $G$, а $G$ — **правым сопряжённым** к $F$.



Здесь нужно прояснить пару моментов. 
- Во-первых, как нам следует понимать: единицу $\eta$ и коединицу $\epsilon$
- Во-вторых, откуда взялись названия «левый/правый сопряжённый» функторы

Давайте сначала разберёмся с первым вопросом. 

## Оживляем определение единицы и коединицы

Начну с общей схемы, которая в различных обличьях постоянно встречается в математике:

1.  Мы часто начинаем с множества $B$.
    *   **Пример:** возьмём в качестве $B$ множество из трёх элементов.
2.  Элементы $B$ затем используются как строительные блоки для конструирования большего математического объекта $F(B)$, который содержит исходное $B$ и нечто ещё.
    * **Пример:** возьмём в качестве $F(B)$ трёхмерное вещественное векторное пространство с базисом $B$.
3.  Как следствие, мы наблюдаем, что всякий раз, когда другой объект тоже «содержит» $B$, он автоматически содержит и $F(B)$.
    *   **Пример:** если $V$ — любое векторное пространство и существует отображение $f$ из $B$ в $V$, то у вас автоматически появляется линейное преобразование $F(B) \to V$. Оно получается линейным продолжением $f$.

Это типичная задача на продолжение. У вас есть маленькое множество $B$. Вы строите из него большой объект $F(B)$. Вы говорите: «О нет, $F(B)$ такой большой и сложный! Как я вообще могу определить из него отображение?» Затем вы с облегчением выдыхаете. Вам достаточно определить ваше отображение на меньшем, более удобном множестве $B$. Всё остальное сделается само собой.

Я проиллюстрировал эту схему на стандартной ситуации из линейной алгебры. Когда нужно определить линейное отображение между векторными пространствами, всегда достаточно определить его на базисных векторах пространства-прообраза, а не на каждом отдельном векторе. Поскольку отображение должно быть линейным, вы знаете, чему оно должно быть равно на произвольном векторе, как только знаете его значения на базисных векторах.

Однако будьте внимательны.

В шаге 3 выше я написал «...отображение $f$ из $B$ в $V$...». Это расплывчато. Что это за морфизм $f$? Является ли он функцией? Линейным преобразованием? Поскольку $B$ — это множество, а $V$ — множество с дополнительной структурой (помните, векторное пространство — это множество вместе с другими вещами), $f$, вероятно, должна быть просто функцией между множествами.

Теория категорий подтверждает это. Действительно, за нашей трёхшаговой схемой скрывается сопряжение. По пути к его раскрытию, сейчас хороший момент узнать, что естественное преобразование единицы $\eta: \text{id}_C \to G \circ F$ для любого сопряжения $F \dashv G$ всегда удовлетворяет следующему свойству:

![[к левому сопряжённому функтору.jpg]] 


Что это значит? Давайте свяжем это с нашим примером из линейной алгебры. Предположим, $D = \mathsf{Vect}_{\mathbb{R}}$ — это категория вещественных векторных пространств, а $C = \mathsf{Set}$ — категория множеств.

Определим функтор $F: \mathsf{Set} \to \mathsf{Vect}_{\mathbb{R}}$ как функтор, который сопоставляет множеству $B$ вещественное векторное пространство $F(B)$, базисом которого является $B$. (Если хотите звучать изысканно, можете назвать $F(B)$ «свободным $\mathbb{R}$-модулем над $B$».)

Определим функтор $U: \mathsf{Vect}_{\mathbb{R}} \to \mathsf{Set}$ как функтор, отправляющий любое векторное пространство $V$ в лежащее в его основе множество $U(V)$ векторов из $V$. (Буква «U» от английского «underlying» — подлежащий.) То есть, $U$ полностью забывает векторную структуру пространства $V$ и рассматривает его просто как множество. Я предоставлю вам подумать о том, что должны делать эти функторы с морфизмами.

Тогда $F$ и $U$ являются частью сопряжения, которое называется **свободно-забывающим сопряжением**.

Единица $\eta: \text{id}_{\mathsf{Set}} \to U \circ F$ этого сопряжения — это естественное преобразование, состоящее из функции $\eta_B: B \to U(F(B))$ для каждого множества $B$. Эта функция просто включает множество $B$ в подлежащее множество векторного пространства $F(B)$. Например, если $B$ — это трёхэлементное множество $\{x, y, z\}$, то $\eta_B$ вкладывает его в множество, элементами которого являются все линейные комбинации $x$, $y$ и $z$, которое мы можем просто считать за $\mathbb{R}^3$. 

![[базис и R3.jpg]] 

Более того, каждая функция $\eta_B$ удовлетворяет свойству, представленному выше: 

![[к левому сопряжённому функтору 2.jpg]]

Отлично, вот перевод этой части.

---

Это в точности та трёхшаговая схема, что была описана выше, только записанная на языке математики. Мы начинаем с множества $B$. Мы используем его, чтобы построить векторное пространство $F(B)$. Это векторное пространство естественным образом содержит исходное множество $B$ посредством включения $\eta_B: B \to U(F(B))$. И всякий раз, когда другое векторное пространство «содержит» $B$ через некоторое отображение $f: B \to U(V)$, оно должно «содержать» и $F(B)$ тоже, посредством отображения $U(\hat{f}): U(F(B)) \to U(V)$.

Обратите внимание на ясность языка: в схеме я сделал расплывчатую отсылку к «...отображению $f$ из $B$ в $V$». Теория категорий явно помещает обсуждение в категорию множеств: $f$ — это функция из множества $B$ в множество $U(V)$. Приведённое выше свойство говорит нам, что для каждой такой функции существует ровно одно линейное отображение $\hat{f}: F(B) \to V$, такое что $f = U(\hat{f}) \circ \eta_B$, что означает: $\hat{f}$ как линейное отображение совпадает с $f$ на базисных элементах. Другими словами, $\hat{f}$ — это единственное отображение, которое линейно продолжает $f$ с базисного множества $B$ на всё векторное пространство $F(B)$. То, что этим свойством обладает единица сопряжения, — именно та причина, по которой нам достаточно определять линейные отображения лишь на базисных элементах.

Существуют и другие свободно-забывающие сопряжения за пределами линейной алгебры. Свободные группы, свободные моноиды, свободные модули над кольцом, свободные кольца на абелевой группе и т.д. — все они подчиняются той же истории. Более общо, всякий раз, когда некоторый функтор «забывает» какие-то данные или структуру и имеет левый сопряжённый, этот левый сопряжённый будет иметь «свободный» характер.

---

## А что на счёт коединицы?

До сих пор обсуждение вращалось вокруг единицы сопряжения. Вкратце скажу о коединице нашего примера, так как коединицы общих сопряжений устроены схожим образом.

Коединица $\epsilon: F \circ U \to \text{id}_{\mathsf{Vect}_{\mathbb{R}}}$ нашего свободно-забывающего сопряжения $F \dashv U$ — это естественное преобразование, состоящее из линейных преобразований $\epsilon_V: F(U(V)) \to V$, где $V$ — векторное пространство. Заметьте, что $U(V)$ — это множество всех векторов в $V$, а $F(U(V))$ — векторное пространство, в котором для каждого элемента из $U(V)$ есть свой базисный вектор. Так что $F(U(V))$ — огромно! Линейное отображение $\epsilon_V$ берёт линейные комбинации элементов множества $U(V)$ — которые являются просто векторами из $V$ — и просто рассматривает их как векторы в $V$. Например, если $V$ имеет базис $x, y, z$, то:

![[сопряжённость 3.jpg|500]] 

Таким образом, коединица здесь говорит: «Линейная комбинация линейных комбинаций векторов из $V$ сама является вектором в $V$, так что просто рассматривай, или вычисляй, эту сумму как этот вектор».

Более того, каждое линейное отображение $\epsilon_V$ удовлетворяет следующему свойству: 

![[сопряжённость 4.jpg]]

Превосходно, вот перевод заключительной части этого раздела.

---

Это свойство говорит о том, что, поскольку линейные комбинации линейных комбинаций векторов из $V$ сами являются векторами в $V$, отображения в $V$ — это именно то, что вы о них и думаете.

В общем случае, буква $\epsilon$ должна напоминать вам «e» от «evaluation» (вычисление), поскольку коединицы сопряжений часто имеют характер «просто вычисли очевидную вещь».

---

## Переупаковка определения

До сих пор мы внимательно изучали единицу и коединицу сопряжения. Но что насчёт названия? Почему функторы называются «сопряжёнными»? И почему они бывают «левыми» и «правыми»? Ответ кроется в переформулировке определения. Вот другой, но эквивалентный способ понять сопряжения:

**Определение:** Сопряжение между категориями $C$ и $D$ — это пара функторов $F: C \to D$ и $G: D \to C$ вместе с биекцией

$$
\text{hom}_{D}(F(X), Y) \cong \text{hom}_{C}(X, G(Y))
$$

для всех объектов $X$ в $C$ и $Y$ в $D$, которая является естественной по обоим аргументам $X$ и $Y$. Образ $\hat{f}$ морфизма $f$ при этой биекции называется **сопряжённым** или **транспонированным** к $f$.

![[сопряжённость 5.jpg]]



Отлично, вот перевод заключительной части.

---

«Естественность по обоим аргументам $X$ и $Y$» означает, что мы требуем, чтобы
$\text{hom}_{D}(F(X), -) \cong \text{hom}_{C}(X, G(-))$
было естественным изоморфизмом для каждого $X$, и чтобы
$\text{hom}_{D}(F(-), Y) \cong \text{hom}_{C}(-, G(Y))$
было естественным изоморфизмом для каждого $Y$.

Суть в том, что $F \dashv G$, если отображения $F(X) \to Y$ — это то же самое, что и отображения $X \to G(Y)$. В нашем свободно-забывающем сопряжении биекция
$\text{hom}_{\mathsf{Vect}_{\mathbb{R}}}(F(B), V) \cong \text{hom}_{\mathsf{Set}}(B, U(V))$
говорит, что существует взаимно-однозначное соответствие между функциями $B \to U(V)$ и линейными преобразованиями $F(B) \to V$. Если у вас есть одно, вы можете получить другое.

Надеюсь, это проливает свет на обозначение $F \dashv G$. В приведённой выше биекции $F$ появляется слева и называется левым сопряжённым к $G$, а $G$ появляется справа и называется правым сопряжённым к $F$. Более того, изоморфизм

$$
\text{hom}_{D}(F(X), Y) \cong \text{hom}_{C}(X, G(Y))
$$

выглядит почти идентично свойству, которым линейное отображение $f: V \to W$ между гильбертовыми пространствами делится со своим сопряжённым оператором $\hat{f}: W \to V$:

$$
\langle f v, w \rangle = \langle v, \hat{f} w \rangle \quad \text{для всех } v \in V, w \in W
$$

что и объясняет терминологию того, что функторы называются "сопряжёнными". 

(К сожалению, мне не известен способ представить гильбертовы пространства как категории так, чтобы линейные отображения и их сопряжённые операторы были бы буквальными категорийными сопряжениями. Но см. работу Джона Баэза «Higher-Dimensional Algebra II: 2-Hilbert Spaces» для категификации этой ситуации.)

Предоставлю вам самим проверить, что два определения сопряжения эквивалентны, как утверждалось. Вот несколько подсказок:

*   Транспонирование тождественного морфизма $F(X)$ при изоморфизме $\text{hom}_{D}(F(X), F(X)) \overset{\cong}{\longrightarrow} \text{hom}_{C}(X, G(F(X)))$ — это единица $\eta$ сопряжения.
*   Транспонирование тождественного морфизма $G(Y)$ при изоморфизме $\text{hom}_{D}(F(G(Y)), Y) \overset{\cong}{\longleftarrow} \text{hom}_{C}(G(Y), G(Y))$ — это коединица $\epsilon$ сопряжения.

Обратите особое внимание на условия естественности, появляющиеся в каждом определении! С помощью этих подсказок вы также можете проверить, что единица и коединица действительно удовлетворяют универсальным свойствам, которые мы исследовали выше.

---

На этом наше исследование формального определения категорных сопряжений завершено. В следующем посте я приведу несколько примеров, которые встречаются как в чистой, так и в прикладной математике.



# Примеры сопряжения

Добро пожаловать в завершающую часть нашей мини-серии о сопряжениях в теории категорий. В [Части 1] мы обсудили мотивацию, а в [Части 2] разобрали формальные определения. Сегодня я приведу несколько примеров. Как хорошо сказал Маклейн, «сопряжённые функторы возникают повсюду», так что этот пост содержит лишь крошечное подмножество примеров. Тем не менее, я надеюсь, они помогут вам развить глазомер для сопряжений и улучшат вашу способность замечать их в других местах.

Напомню, что сопряжение состоит из пары функторов $F \dashv G$ между категориями $C$ и $D$ вместе с биекцией множеств, как показано ниже, для всех объектов $X$ в $C$ и $Y$ в $D$:

$$
\text{hom}_{D}(F(X), Y) \cong \text{hom}_{C}(X, G(Y))
$$

![[сопряжённость 6.jpg]]


В Части 2 мы проиллюстрировали эту биекцию на примере свободно-забывающего сопряжения из линейной алгебры. Так что давайте поставим «свободно-забывающие сопряжения» первыми в сегодняшнем списке примеров.

---

## Свободно-забывающие сопряжения

Всякий раз, когда функтор $U: D \to C$ игнорирует некоторые данные или структуру в $D$ и имеет левый сопряжённый $F: C \to D$, этот левый сопряжённый будет иметь «свободный» характер. Поскольку правый сопряжённый является «забывающим» (этот термин не имеет строгого формального определения), такое сопряжение $F \dashv U$ называется **свободно-забывающим сопряжением**.

На прошлой неделе мы видели это на примере множеств и вещественных векторных пространств. Другая иллюстрация лежит в связи между **ориентированными графами** и **категориями**. Оба понятия включают вершины/объекты и рёбра/морфизмы. Так как же именно они связаны? Каждый ориентированный граф порождает категорию, и каждая категория является ориентированным графом (с дополнительной структурой). Более формально, существует сопряжение между категорией $\mathsf{DirGraph}$ ориентированных графов и категорией $\mathsf{Cat}$ категорий. 

![[сопряжённость 7.jpg]]

На картинке выше функтор $F$ превращает граф $G$ в категорию $F(G)$, рассматривая вершины как объекты, а рёбра — как морфизмы. Он также добавляет тождественные стрелки в каждой вершине и объявляет множество морфизмов между двумя вершинами множеством всех конечных путей между ними. Композиция в таком случае — это конкатенация путей.

С другой стороны, функтор $U$ сопоставляет категории $C$ её подлежащий граф $U(C)$. Он просто «забывает» аксиомы тождественного морфизма и композиции, которые не нужны для определения графа.

Биекция, обеспечиваемая этим сопряжением, выглядит так: 

![[сопряжённость 8.jpg]]


что можно пересказать так: «Если вы хотите рассматривать граф $G$ как диаграмму в некоторой категории $C$, то вам повезло, потому что есть ровно один способ превратить этот граф в категорию $F(G)$, так что диаграмма $G$ в $C$ будет функтором $F(G) \to C$». Это напоминает идею, с которой мы уже сталкивались: **диаграммы — это функторы**.

---

## Сопряжение Произведение-Hom

Следующий пример даёт прекрасное категорийное соотношение между умножением и возведением в степень. В раннем возрасте мы узнаём, что $x^{y \times z} = (x^y)^z$ выполняется, когда $x$, $y$, $z$ — числа. Позже мы узнаём, что это верно и для множеств:

![[сопряжённость 9.jpg]]

Это называется **сопряжением произведение-hom**. Чтобы разобраться, давайте использовать обозначение $X^Y$ для множества функций из $Y$ в $X$, то есть $X^Y := \text{hom}(Y, X)$. Это удобно, поскольку если $X$ имеет 2 элемента, а $Y$ — 3 элемента, то существует ровно 8 функций из $Y$ в $X$, т.е. $|\text{hom}(Y, X)| = 2^3 = |X|^{|Y|}$.

Теперь, почему указанная выше биекция является сопряжением? Для любого множества $Y$ существует функтор $Y \times - : \mathsf{Set} \to \mathsf{Set}$, который сопоставляет множеству $Z$ декартово произведение $Y \times Z$. Существует другой функтор $\text{hom}(Y, -) : \mathsf{Set} \to \mathsf{Set}$, который сопоставляет множеству $Z$ множество всех функций $\text{hom}(Y, Z)$. Тогда $Y \times -$ является **левым сопряжённым** к $\text{hom}(Y, -)$.

![[сопряжённость 10.jpg]]

Другими словами, для всех множеств $X$ и $Z$ имеет место следующая биекция:

$$
\text{hom}(Y \times Z, X) \cong \text{hom}(Z, X^Y)
$$
![[сопряжённость 11.jpg]]

Действительно, каждая функция $f: Y \times Z \to X$ порождает функцию $\hat{f}_z: Y \to X$ путём фиксации переменной $z \in Z$, а именно $\hat{f}_z(y) := f(y, z) \in X$. Аналогично, любая функция $g: Z \to X^Y$ порождает функцию $\hat{g}: Y \times Z \to X$ по правилу $\hat{g}(y, z) := g_z(y)$. В информатике вы узнаете в этом **каррирование** (currying).

Другие области математики имеют свою собственную версию сопряжения произведение-hom. Например, если $X$, $Y$, $Z$ — топологические пространства с выбранными отмеченными точками, то существует «отмеченная» версия декартова произведения пространств, называемая **свёрткой** (smash product) и обозначаемая знаком $\wedge$. К примеру, «умножение» двух окружностей с помощью декартова произведения даёт тор, $S^1 \times S^1$. Но если вы далее свернёте две окружности вместе, то получите сферу. Таким образом, свёртка окружностей $S^1 \wedge S^1$ — это сфера. Вот удачная гифка из Википедии:

![[сопряжённость 12.gif]]

Таким образом, аналогом произведения $\times$ является свёртка $\wedge$, а соответствующее сопряжение $(Y \wedge -) \dashv \text{hom}(Y, -)$ называется **сопряжением свёртка-hom**. В частном случае, когда $Y = S^1$ — это окружность, два функтора $S^1 \times -$ и $\text{hom}(S^1, -)$ называются **функторами надстройки и петли** (suspension and loop functors), а получающееся сопряжение — **сопряжением надстройка-петля** (suspension-loop adjunction). Оно появляется в изящном однострочном доказательстве того, что фундаментальная группа окружности равна $\mathbb{Z}$.

---

## Связи Галуа

Следующее сопряжение, которое мы рассмотрим, называется **связью Галуа** (Galois connection). Это мой любимый пример, потому что он охватывает множество явлений в математике. Связь Галуа — это, попросту говоря, сопряжение между функторами на частично упорядоченных множествах (ч.у.м.).

Объясню. Во-первых, знайте, что каждое ч.у.м. (частично упорядоченное множество) — это категория. Ч.у.м. — это множество $P$, на котором определён частичный порядок $\leq$. Как категория, объекты — это элементы $P$, и существует ровно один морфизм $p \to p'$ всякий раз, когда $p \leq p'$. В частности, между любыми двумя элементами есть не более одной стрелки, то есть $\text{hom}(p, p')$ — это всегда множество, содержащее либо 0, либо 1 элемент. Используя определение частичного порядка, вы можете проверить, что аксиомы категории действительно выполняются.

Функция $f: P \to Q$ между ч.у.м., сохраняющая порядок — то есть удовлетворяющая условию $f(p) \leq f(p')$ всякий раз, когда $p \leq p'$ — называется **монотонной функцией**. Ключевой момент: монотонная функция — это в точности функтор, когда мы рассматриваем ч.у.м. как категории. (Ниже нас будет интересовать функция $f$, которая **обращает порядок**, так что $f(p) \geq f(p')$ при $p \leq p'$. Это всё ещё функтор — просто контравариантный.)

В этой общей setting'е, сопряжение состоит из противоположно направленных монотонных функций $f: P \to Q$ и $g: Q \to P$, удовлетворяющих условию:

![[сопряжённость 13.jpg]]


Множество вещей, которые вас могут интересовать, являются ч.у.м., поэтому связи Галуа повсеместно встречаются в математике. Вот один пример, который мне особенно нравится:

---

## Анализ формальных понятий (Formal Concept Analysis)

Рассмотрим булеан $2^X$, т.е. множество всех подмножеств множества $X$. Это ч.у.м. по отношению включения: $A \leq B$ если и только если $A \subseteq B \subseteq X$. В частности, это категория. Вот интересный факт, который мне нравится:

**Любое отношение $R$ на $X \times Y$ определяет связь Галуа.**

Отношение — это другое название для подмножества $R \subseteq X \times Y$. Если, например, $X$ — это множество животных, а $Y$ — множество признаков, то $R$ может быть множеством всех пар $(x, y)$ таких, что животное $x$ обладает признаком $y$. Естественно, нас могут интересовать подмножества животных, обладающих определёнными признаками, и наоборот. Это мотивирует определение двух следующих функций, $f$ и $g$:

![[сопряжённость 14.jpg]]

Эти функции являются обращающими порядок (как вы можете проверить), и они удовлетворяют следующему условию:

![[сопряжённость 15.jpg]]

Сразу же вы заметите, что это не совсем условие сопряжения, указанное выше: $f$ и $g$ обе появляются в правой части включений подмножеств! Не беспокойтесь. Это сопряжение другого типа: $f$ и $g$ называются **взаимно правыми сопряжёнными**, и это пример того, что иногда называют **антитонной связью Галуа**.

Кстати, пары подмножеств $(A, B) \in 2^X \times 2^Y$, для которых выполняется равенство выше — т.е. $f(A) = B$ и $A = g(B)$ — имеют специальное название: они называются **формальными понятиями**. Они являются центральным объектом интереса в анализе формальных понятий — прекрасном разделе теории порядка, занимающемся иерархией понятий в данных. Для получения дополнительной информации о формальных понятиях и теории категорий вам может быть интересна эта серия блогов Саймона Уиллертона на \(n\)-Category Café.

Связи Галуа, возникающие из отношений — всего лишь один пример. Их существует гораздо больше, включая:

*   связь между полями и группами в теории Галуа (от которой это сопряжение и получило своё название);
*   связь между функцией пола $\lfloor - \rfloor$ и функцией потолка $\lceil - \rceil$;
*   связь между накрывающими пространствами и фундаментальными группами в топологии;
*   связь между многочленами и их корнями в алгебраической геометрии;
*   связь между синтаксисом и семантикой в духе Уильяма Ловера.

Список можно продолжать, и статья в Википедии демонстрирует большинство этих примеров и не только.

---

## Миграция данных (Data Migration)

Наш последний пример сопряжений происходит из прикладной теории категорий, а именно — **миграции данных**. Сегодняшний пост уже достаточно длинный, поэтому я постараюсь быть кратким. Базу данных — таблицы с информацией — можно представить в виде ориентированного графа, $G$. Столбцы — это вершины, а рёбра — это отношения между столбцами. В примере с авиакомпанией ниже столбец «Эконом-места» соответствует одной вершине, которая соединена с «Ценой», поскольку каждое место имеет связанную с ним стоимость.

![[сопряжённость 16.jpg]]

Граф отслеживает «синтаксис» базы данных. Чтобы восстановить сами данные, нам нужно придать значения. Нам нужен, например, принципиальный способ «считать, что левая вершина представляет множество мест эконом-класса». Чтобы сделать это, мы берём свободную категорию $C := F(G)$ на графе (как в свободно-забывающем сопряжении выше!) и определяем функтор из этой категории в категорию множеств. Короче говоря, база данных кодируется функтором $C \to \mathsf{Set}$.


![[сопряжённость 17.jpg]]

Теперь предположим, что у нас есть другая база данных, чей граф $H$ порождает категорию $D := F(H)$, и предположим, что две базы данных связаны так, что существует функтор $J: D \to C$. (Возможно, одна база данных является более детальной версией другой.) Запрос на **миграцию данных** из $C$ в $D$ равносилен запросу на получение функтора $D \to \mathsf{Set}$ при заданном функторе $C \to \mathsf{Set}$. Возможно ли это? Конечно! Достаточно просто предварительно скомпоновать с $J$. Это определяет хороший способ перехода от категории $\mathsf{Set}^C$ баз данных (функторов) на $C$ к категории $\mathsf{Set}^D$ баз данных (функторов) на $D$:


![[сопряжённость 18.jpg]]

Но можем ли мы мигрировать данные в обратном направлении? Имея функтор $D \to \mathsf{Set}$, можем ли мы использовать $J$, чтобы *расширить* его до функтора из $C$? Для этого мы обращаемся к **продолжениям Кана** (Kan extensions) — так называется решение задач такого типа расширения. Я использую множественное число, потому что существуют как *левые, так и правые продолжения Кана*. (Это следствие того факта, что морфизмы имеют направление: левое или правое.)

За этим стоит богатая теория (вам нужно будет знать о [[пределы и копределы|пределах и копределах]] , но суть в том, что два продолжения Кана предоставляют два способа миграции данных из $D$ в $C$. Более того, они определяют *два* сопряжения:

![[сопряжённость 19.jpg]]

Я изложил всё это довольно быстро, но думаю, что это даёт хорошее представление о прикладной теории категорий. Подробное объяснение можно найти в книге Дэвида Спивака «Category Theory for the Sciences» и в более новой книге «An Invitation to Applied Category Theory», написанной в соавторстве с Бренданом Фонгом, которая также доступна бесплатно на arXiv под названием «Seven Sketches in Compositionality». (См. раздел 3.4, «Adjunctions and Data Migration», из которого я позаимствовал приведённый выше пример.) Джон Баэз также прекрасно объясняет эту идею в своём бесплатном онлайн-курсе по прикладной теории категорий. Обязательно ознакомьтесь с ними!


--- 



## Ссылки на источники: 

Текст статей адаптирован и дополнен на основе статей блога https://www.math3ma.com 
" What is an Adjunction?" (3 части) 
- https://www.math3ma.com/blog/what-is-an-adjunction-part-1 
- https://www.math3ma.com/blog/what-is-an-adjunction-part-2 
- https://www.math3ma.com/blog/what-is-an-adjunction-part-3 

Дополнительные визуализации: 
- https://en.wikipedia.org/wiki/Smash_product#/media/File:Visualization_of_the_smash_product_of_two_circles.gif 
- 


